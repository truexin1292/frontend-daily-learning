<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>share-friends</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui, viewport-fit=cover">
  <script src="https://cdn.bootcss.com/jquery/3.4.0/jquery.js"></script>
  <script src="http://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script>
</head>
<body>

<script type="text/javascript">
  var imgUrl = 'http://f.fengchaoli.com/plug-in/fcl/images/guideRegister3.png';
  var lineLink = 'http://f.fengchaoli.com/registerController.do?guide';
  var descContent = 'äººç±»å¤©ç”Ÿå°±çˆ±ç©æ¸¸æˆï¼Œæ¸¸æˆä¸ºä»€ä¹ˆå¸å¼•äººï¼Ÿå¦‚æœå€ŸåŠ©æ¸¸æˆçš„è§„å¾‹ï¼Œæ˜¯å¦å¯ä»¥è®©å·¥ä½œå­¦ä¹ å˜å¾—æ›´ç²¾å½©ï¼Ÿ';
  var shareTitle = 'æ¸¸æˆåŒ–å­¦ä¹ å·¥ä½œåŠç¬¬å››ç«™-åŒ—äº¬æ¸…åç§‘æŠ€å›­';

  $.ajax({
    type: 'GET',
    url: "https://sb.leyaoyao.com/lyy/rest/group/distributor/wechat/config",
    dataType: "jsonp",
    data: {
      currentPageUrl: encodeURIComponent(location.href),
    },
    success: function (res) {
      if (res.data.result === 0) {
        const configData = res.data.data;
        wx.config({
          appId: configData.appId,
          timestamp: configData.timestamp,
          nonceStr: configData.nonceStr,
          signature: configData.signature,
          jsApiList: [
            'checkJsApi',
            'updateAppMessageShareData',
            'onMenuShareTimeline',
            'onMenuShareAppMessage'
          ]
        });
        wx.ready(() => {
          console.log('é…ç½®æˆåŠŸ');
        });
        wx.error(() => {
          console.log('é…ç½®å¤±è´¥');
        });
      }
    },
    error: function (response) {
      console.log("å¤±è´¥", response);
    }
  });

  function shareOnWechat() {
    wx.onMenuShareAppMessage({
      title: shareTitle, // åˆ†äº«æ ‡é¢˜
      desc: descContent, // åˆ†äº«æè¿°
      link: lineLink, // åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´
      imgUrl: imgUrl, // åˆ†äº«å›¾æ ‡
      type: '', // åˆ†äº«ç±»å‹,musicã€videoæˆ–linkï¼Œä¸å¡«é»˜è®¤ä¸ºlink
      dataUrl: '', // å¦‚æœtypeæ˜¯musicæˆ–videoï¼Œåˆ™è¦æä¾›æ•°æ®é“¾æ¥ï¼Œé»˜è®¤ä¸ºç©º
      success: function (res) {
        // ç”¨æˆ·ç¡®è®¤åˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°
        alert(res)
      },
      cancel: function () {
        // ç”¨æˆ·å–æ¶ˆåˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°
        alert('error', res)
      }
    });
  }
</script>
<div onclick="shareOnWechat()">
  åˆ†äº«åˆ°æœ‹å‹åœˆå’Œæœ‹å‹ğŸ‘¬
</div>
</body>
</html>
