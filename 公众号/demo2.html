<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>share-friends</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui, viewport-fit=cover">
    <script src="https://cdn.bootcss.com/jquery/3.4.0/jquery.js"></script>
    <!--<script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>-->
    <script src="http://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script>
</head>
<body>

<script type="text/javascript">
    // var imgUrl = 'http://f.fengchaoli.com/plug-in/fcl/images/guideRegister3.png';
    var imgUrl = 'http://e-fcl.test.fengchaoli.com/plug-in/fcl/images/guideRegister1.png';
    // var lineLink = 'http://f.fengchaoli.com/registerController.do?guide';
    var lineLink = 'http://e-fcl.test.fengchaoli.com/registerController.do?guide';
    var descContent = 'äººç±»å¤©ç”Ÿå°±çˆ±ç©æ¸¸æˆï¼Œæ¸¸æˆä¸ºä»€ä¹ˆå¸å¼•äººï¼Ÿå¦‚æœå€ŸåŠ©æ¸¸æˆçš„è§„å¾‹ï¼Œæ˜¯å¦å¯ä»¥è®©å·¥ä½œå­¦ä¹ å˜å¾—æ›´ç²¾å½©ï¼Ÿ';
    var shareTitle = 'æ¸¸æˆåŒ–å­¦ä¹ å·¥ä½œåŠç¬¬å››ç«™-åŒ—äº¬æ¸…åç§‘æŠ€å›­';
    // var data = {
    //     // url: location.href.split('#')[0],
    //     url: encodeURIComponent(location.href.split('#')[0])
    // };

    $.ajax({
        type: 'GET',
        url: "http://4d125132.ngrok.io/token",
        dataType: "json",
        // data: data,
        // timeout: 15000,
        success: function (response) {
            var appId = response.appId;
            var timestamp = response.timestamp;
            var nonceStr = response.nonceStr;
            var signature = response.signature;
            // var ticket = response.ticket;
            // var ticket = response.jsapi_ticket;

            wx.config({
                debug: false,
                appId: appId,
                timestamp: timestamp,
                nonceStr: nonceStr,
                signature: signature,
                jsApiList: [
                    // 'checkJsApi',
                    // 'updateAppMessageShareData',
                    // 'onMenuShareTimeline',
                    'onMenuShareAppMessage'
                ]
            });
            wx.ready(function () {
                // wx.checkJsApi({
                //     jsApiList: ['onMenuShareAppMessage'], // éœ€è¦æ£€æµ‹çš„JSæ¥å£åˆ—è¡¨ï¼Œæ‰€æœ‰JSæ¥å£åˆ—è¡¨è§é™„å½•2,
                //     success: function (res) {
                //         console.log('--onMenuShareAppMessage--:', res)
                //         // ä»¥é”®å€¼å¯¹çš„å½¢å¼è¿”å›ï¼Œå¯ç”¨çš„apiå€¼trueï¼Œä¸å¯ç”¨ä¸ºfalse
                //         // å¦‚ï¼š{"checkResult":{"chooseImage":true},"errMsg":"checkJsApi:ok"}
                //     }
                // });
                // wx.updateAppMessageShareData({
                //     title: shareTitle, // åˆ†äº«æ ‡é¢˜
                //     desc: descContent, // åˆ†äº«æè¿°
                //     link: lineLink, // åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´
                //     imgUrl: imgUrl, // åˆ†äº«å›¾æ ‡
                //     // type: "link", // åˆ†äº«ç±»å‹,musicã€videoæˆ–linkï¼Œä¸å¡«é»˜è®¤ä¸ºlink
                //     // dataUrl: "", // å¦‚æœtypeæ˜¯musicæˆ–videoï¼Œåˆ™è¦æä¾›æ•°æ®é“¾æ¥ï¼Œé»˜è®¤ä¸ºç©º
                //     success: function (res) {
                //         console.log('--onMenuShareAppMessage--:', res)
                //         // ç”¨æˆ·ç¡®è®¤åˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°
                //         console.log("åˆ†äº«é…ç½®å®Œæˆ");
                //     },
                //     cancel: function (res) {
                //         console.log('--error--:', res)
                //         // ç”¨æˆ·å–æ¶ˆåˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°
                //         console.log('åˆ†äº«å–æ¶ˆ')
                //     }
                // });
                // wx.onMenuShareTimeline({
                //     title: shareTitle, // åˆ†äº«æ ‡é¢˜
                //     link: lineLink, // åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´
                //     imgUrl: imgUrl, // åˆ†äº«å›¾æ ‡
                //     success: function () {
                //         // ç”¨æˆ·ç¡®è®¤åˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°
                //     },
                //     cancel: function () {
                //         // ç”¨æˆ·å–æ¶ˆåˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°
                //     }
                // });
                wx.onMenuShareAppMessage({
                    title: shareTitle, // åˆ†äº«æ ‡é¢˜
                    desc: descContent, // åˆ†äº«æè¿°
                    link: lineLink, // åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´
                    imgUrl: imgUrl, // åˆ†äº«å›¾æ ‡
                    type: '', // åˆ†äº«ç±»å‹,musicã€videoæˆ–linkï¼Œä¸å¡«é»˜è®¤ä¸ºlink
                    dataUrl: '', // å¦‚æœtypeæ˜¯musicæˆ–videoï¼Œåˆ™è¦æä¾›æ•°æ®é“¾æ¥ï¼Œé»˜è®¤ä¸ºç©º
                    success: function () {
                        // ç”¨æˆ·ç¡®è®¤åˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°

                    },
                    cancel: function () {
                        // ç”¨æˆ·å–æ¶ˆåˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°
                    }
                });
            });
        },
        error: function (response) {
            console.log("å¤±è´¥", response);
        }
    });

    function shareOnWechat() {
        wx.onMenuShareAppMessage({
            title: shareTitle, // åˆ†äº«æ ‡é¢˜
            desc: descContent, // åˆ†äº«æè¿°
            link: lineLink, // åˆ†äº«é“¾æ¥ï¼Œè¯¥é“¾æ¥åŸŸåæˆ–è·¯å¾„å¿…é¡»ä¸å½“å‰é¡µé¢å¯¹åº”çš„å…¬ä¼—å·JSå®‰å…¨åŸŸåä¸€è‡´
            imgUrl: imgUrl, // åˆ†äº«å›¾æ ‡
            type: '', // åˆ†äº«ç±»å‹,musicã€videoæˆ–linkï¼Œä¸å¡«é»˜è®¤ä¸ºlink
            dataUrl: '', // å¦‚æœtypeæ˜¯musicæˆ–videoï¼Œåˆ™è¦æä¾›æ•°æ®é“¾æ¥ï¼Œé»˜è®¤ä¸ºç©º
            success: function (res) {
                // ç”¨æˆ·ç¡®è®¤åˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°
                alert(res)
            },
            cancel: function () {
                // ç”¨æˆ·å–æ¶ˆåˆ†äº«åæ‰§è¡Œçš„å›è°ƒå‡½æ•°
                alert('error', res)
            }
        });
    }
</script>
<div onclick="shareOnWechat()">
    åˆ†äº«åˆ°æœ‹å‹åœˆå’Œæœ‹å‹ğŸ‘¬
</div>
</body>
</html>
